"use strict";let $btnMail,$restartBtn,$movesResult,$timeResult,$pausePlayBtn,$divZero,$puzzles,$playAgainBtn,$gameResults,$congratulationsBar,$countSeconds,$pauseBar,$playBtn,$timeCounter=0,$movesCounter=0;const main=()=>{prepareDOMElements(),prepareDOMEvents(),fillPuzzles(),isInRightPoisition()},prepareDOMElements=()=>{$btnMail=document.querySelector(".btn-mail"),$puzzles=[...document.getElementsByClassName("game-puzzle")],$restartBtn=document.querySelector(".btn-restart"),$movesResult=document.querySelector(".move-result"),$timeResult=document.querySelector(".seconds"),$pausePlayBtn=document.querySelector(".btn-pause-play"),$playAgainBtn=document.querySelector(".btn-play-again"),$gameResults=document.querySelector(".game-results"),$congratulationsBar=document.querySelector(".congratulations-bar"),$pauseBar=document.querySelector(".pause-bar"),$playBtn=$pauseBar.querySelector(".play-btn")},prepareDOMEvents=()=>{movePuzzle(),$restartBtn.addEventListener("click",restartGame),$pausePlayBtn.addEventListener("click",pauseOrPlay),$playBtn.addEventListener("click",playAfterPause),$btnMail.addEventListener("click",copyMail),$playAgainBtn.addEventListener("click",playAgain)},fillPuzzles=()=>{const e=new Set;for(;16!==e.size;)e.add(Math.floor(16*Math.random()));const t=[...e];let s=0;for(let e of $puzzles){if(0===t[s]){let t=e.querySelector("div");($divZero=e).removeChild(t),$divZero.classList.add("zero-puzzle")}else e.querySelector("p").innerHTML=t[s];s++}},isInRightPoisition=()=>{for(let e=0;e<$puzzles.length;e++){const t=$puzzles[e].querySelector(".puzzle-box");if(null!==t){t.querySelector(".puzzle-number").innerHTML===`${e+1}`?t.classList.add("right-position"):t.classList.remove("right-position")}}},movePuzzle=()=>{$puzzles.forEach(e=>{e.addEventListener("click",function(){let e=$puzzles.indexOf(this),t=$puzzles.indexOf($divZero);if(e!==t){const s=[3,7,11],a=[4,8,12];(e-1===t&&!a.includes(e)||e+1===t&&!s.includes(e)||e+4===t||e-4===t)&&($divZero.appendChild(this.firstChild),$divZero.classList.remove("zero-puzzle"),$divZero=this,$movesCounter++,this.classList.add("zero-puzzle"),isInRightPoisition(),0!==$movesCounter&&($pausePlayBtn.classList.remove("disactive"),$pausePlayBtn.removeAttribute("disabled")),0===$timeCounter&&($timeCounter++,$timeResult.innerHTML=$timeCounter,$countSeconds=setInterval(timer,1e3,1/0)),$movesResult.innerHTML=$movesCounter)}isFinished()})})},isFinished=()=>{let e=0;for(let t=0;t<15;t++)null!==$puzzles[t].querySelector("p")&&$puzzles[t].querySelector("p").innerText==t+1&&e++;15===e&&userWins()},userWins=()=>{$restartBtn.classList.add("disactive"),$restartBtn.setAttribute("disabled","disabled"),$pausePlayBtn.classList.add("disactive"),$pausePlayBtn.disabled=!0,$gameResults.classList.add("disactive"),$congratulationsBar.classList.add("active"),$congratulationsBar.querySelector(".final-moves").innerHTML=$movesCounter,$congratulationsBar.querySelector(".final-time").innerHTML=$timeCounter,$movesCounter=0,$movesResult.innerHTML=$movesCounter,$timeCounter=0,$timeResult.innerHTML=$timeCounter,stopTimer()},pauseOrPlay=()=>{"Pause"===$pausePlayBtn.innerHTML?(stopTimer(),$pausePlayBtn.innerHTML="Play",$pauseBar.style.display="block"):playAfterPause()},playAfterPause=()=>{$countSeconds=setInterval(timer,1e3,1/0),$pausePlayBtn.innerHTML="Pause",$pauseBar.style.display="none"},timer=()=>{$timeCounter++,$timeResult.innerHTML=$timeCounter},stopTimer=()=>{clearInterval($countSeconds)},restartGame=()=>{addChildToRestart(),$divZero.classList.remove("zero-puzzle"),fillPuzzles(),$movesCounter=0,$movesResult.innerHTML=$movesCounter,$timeCounter=0,$timeResult.innerHTML=$timeCounter,$pauseBar.style.display="none",$pausePlayBtn.innerHTML="Pause",$pausePlayBtn.classList.add("disactive"),$pausePlayBtn.setAttribute("disabled","disabled"),stopTimer(),isInRightPoisition(),$puzzles.forEach(e=>animatePuzzle(e))},addChildToRestart=()=>{const e=document.createElement("div");e.classList.add("puzzle-box");const t=document.createElement("p");t.classList.add("puzzle-number"),t.innerHTML="",e.appendChild(t),$divZero.appendChild(e)},animatePuzzle=e=>{e.querySelector(".puzzle-box")&&e.querySelector(".puzzle-box").animate([{transform:"scale(.7)"},{transform:"scale(1)"}],{duration:300,iterations:1,easing:"ease"})},playAgain=()=>{addChildToRestart(),$divZero.classList.remove("zero-puzzle"),fillPuzzles(),$restartBtn.classList.remove("disactive"),$gameResults.classList.remove("disactive"),$restartBtn.removeAttribute("disabled"),$congratulationsBar.animate([{opacity:".95",transform:"translate(-50%,-50%) scale(1)"},{opacity:"0",transform:"translate(-50%,-50%) scale(0)"}],{duration:500,iterations:1,easing:"ease"}),window.setTimeout(function(){$congratulationsBar.classList.remove("active")},480),isInRightPoisition()},showMailInfo=()=>{const e=document.querySelector(".mail-info");e.classList.add("active"),window.setTimeout(function(){e.classList.remove("active")},3999)},copyMail=()=>{showMailInfo();const e=document.querySelector(".my-mail"),t=document.createRange();t.selectNode(e),window.getSelection().addRange(t),document.execCommand("copy"),window.getSelection().removeAllRanges()};document.addEventListener("DOMContentLoaded",main);